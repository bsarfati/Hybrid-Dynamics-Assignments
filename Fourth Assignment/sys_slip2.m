function dXdt=sys_slip2(t,X)
        m1=5; m2=15; g=10;R=0.6;h=0.4;l=0.2;J1=0.1*m1*R^2;J2=0.5*m2*l^2;mu=0.05;


    x=X(1);x_d=X(5);
    y=X(2);y_d=X(6);
    theta=X(3);theta_d=X(7);
    phi=X(4);phi_d=X(8);
    global sgn_slip

    dq1=X(5:8);
    dq2= [((J1*l^2*m2^2*cos(phi + theta)*sin(phi + theta) + J2*h^2*m1^2*cos(theta)*sin(theta) + h^2*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta) + h^2*l^2*m1^2*m2*cos(theta)*sin(theta))*(theta_d*(l*m2*cos(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*cos(theta)) - (2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + g*(m2 + m1) + l*m2*phi_d*cos(phi + theta)*(phi_d + theta_d)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - ((g*l*m2*sin(phi + theta) + g*h*m1*sin(theta) + (R*mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)))*(J2*h*m1^2*cos(theta) + h*l^2*m1*m2^2*cos(theta) + h*l^2*m1^2*m2*cos(theta) + J2*h*m1*m2*cos(theta) - h*l^2*m1*m2^2*sin(phi + theta)^2*cos(theta) + h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*sin(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - ((theta_d*(l*m2*sin(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*sin(theta)) - (mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + l*m2*phi_d*sin(phi + theta)*(phi_d + theta_d))*(J2*h^2*m1^2 + J1*l^2*m2^2 + J1*J2*m1 + J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + J2*h^2*m1*m2 + J1*l^2*m1*m2 - J1*l^2*m2^2*sin(phi + theta)^2 - J2*h^2*m1^2*sin(theta)^2 - h^2*l^2*m1*m2^2*sin(phi + theta)^2 - h^2*l^2*m1^2*m2*sin(theta)^2))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - (g*l*m2*sin(phi + theta)*(J1*l*m2^2*cos(phi + theta) - J2*h*m1^2*cos(theta) + h^2*l*m1*m2^2*cos(phi + theta) + h^2*l*m1^2*m2*cos(phi + theta) + J1*l*m1*m2*cos(phi + theta) - h*l^2*m1*m2^2*cos(theta) - h*l^2*m1^2*m2*cos(theta) - J2*h*m1*m2*cos(theta) + h*l^2*m1*m2^2*sin(phi + theta)^2*cos(theta) - h^2*l*m1^2*m2*cos(phi + theta)*sin(theta)^2 - h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*sin(theta) + h^2*l*m1^2*m2*sin(phi + theta)*cos(theta)*sin(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)); ((theta_d*(l*m2*cos(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*cos(theta)) - (2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + g*(m2 + m1) + l*m2*phi_d*cos(phi + theta)*(phi_d + theta_d))*(J2*h^2*m1^2 + J1*l^2*m2^2 + J1*J2*m1 + J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 - J1*l^2*m2^2*cos(phi + theta)^2 + J2*h^2*m1*m2 + J1*l^2*m1*m2 - J2*h^2*m1^2*cos(theta)^2 - h^2*l^2*m1*m2^2*cos(phi + theta)^2 - h^2*l^2*m1^2*m2*cos(theta)^2))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - ((g*l*m2*sin(phi + theta) + g*h*m1*sin(theta) + (R*mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)))*(J2*h*m1^2*sin(theta) + h*l^2*m1*m2^2*sin(theta) + h*l^2*m1^2*m2*sin(theta) + J2*h*m1*m2*sin(theta) - h*l^2*m1*m2^2*cos(phi + theta)^2*sin(theta) + h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - ((theta_d*(l*m2*sin(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*sin(theta)) - (mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + l*m2*phi_d*sin(phi + theta)*(phi_d + theta_d))*(J1*l^2*m2^2*cos(phi + theta)*sin(phi + theta) + J2*h^2*m1^2*cos(theta)*sin(theta) + h^2*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta) + h^2*l^2*m1^2*m2*cos(theta)*sin(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - (g*l*m2*sin(phi + theta)*(J1*l*m2^2*sin(phi + theta) - J2*h*m1^2*sin(theta) + h^2*l*m1*m2^2*sin(phi + theta) + h^2*l*m1^2*m2*sin(phi + theta) + J1*l*m1*m2*sin(phi + theta) - h*l^2*m1*m2^2*sin(theta) - h*l^2*m1^2*m2*sin(theta) - J2*h*m1*m2*sin(theta) + h*l^2*m1*m2^2*cos(phi + theta)^2*sin(theta) - h^2*l*m1^2*m2*sin(phi + theta)*cos(theta)^2 - h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta) + h^2*l*m1^2*m2*cos(phi + theta)*cos(theta)*sin(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)); ((theta_d*(l*m2*sin(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*sin(theta)) - (mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + l*m2*phi_d*sin(phi + theta)*(phi_d + theta_d))*(J2*h*m1^2*cos(theta) + h*l^2*m1*m2^2*cos(theta) + h*l^2*m1^2*m2*cos(theta) + J2*h*m1*m2*cos(theta) - h*l^2*m1*m2^2*sin(phi + theta)^2*cos(theta) + h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*sin(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - ((theta_d*(l*m2*cos(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*cos(theta)) - (2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + g*(m2 + m1) + l*m2*phi_d*cos(phi + theta)*(phi_d + theta_d))*(J2*h*m1^2*sin(theta) + h*l^2*m1*m2^2*sin(theta) + h*l^2*m1^2*m2*sin(theta) + J2*h*m1*m2*sin(theta) - h*l^2*m1*m2^2*cos(phi + theta)^2*sin(theta) + h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) + ((g*l*m2*sin(phi + theta) + g*h*m1*sin(theta) + (R*mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)))*(J2*m1^2 + J2*m2^2 + l^2*m2^3 - l^2*m2^3*sin(phi + theta)^2 + 2*l^2*m1*m2^2 + l^2*m1^2*m2 + 2*J2*m1*m2 - l^2*m2^3*cos(phi + theta)^2 - l^2*m1*m2^2*cos(phi + theta)^2 - l^2*m1*m2^2*sin(phi + theta)^2))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) + (g*l*m2*sin(phi + theta)*(l^2*m2^3*sin(phi + theta)^2 - J2*m2^2 - l^2*m2^3 - J2*m1^2 - 2*l^2*m1*m2^2 - l^2*m1^2*m2 - 2*J2*m1*m2 + l^2*m2^3*cos(phi + theta)^2 + l^2*m1*m2^2*cos(phi + theta)^2 + l^2*m1*m2^2*sin(phi + theta)^2 + h*l*m1*m2^2*sin(phi + theta)*sin(theta) + h*l*m1^2*m2*sin(phi + theta)*sin(theta) + h*l*m1*m2^2*cos(phi + theta)*cos(theta) + h*l*m1^2*m2*cos(phi + theta)*cos(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)); ((theta_d*(l*m2*sin(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*sin(theta)) - (mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + l*m2*phi_d*sin(phi + theta)*(phi_d + theta_d))*(J1*l*m2^2*cos(phi + theta) - J2*h*m1^2*cos(theta) + h^2*l*m1*m2^2*cos(phi + theta) + h^2*l*m1^2*m2*cos(phi + theta) + J1*l*m1*m2*cos(phi + theta) - h*l^2*m1*m2^2*cos(theta) - h*l^2*m1^2*m2*cos(theta) - J2*h*m1*m2*cos(theta) + h*l^2*m1*m2^2*sin(phi + theta)^2*cos(theta) - h^2*l*m1^2*m2*cos(phi + theta)*sin(theta)^2 - h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*sin(theta) + h^2*l*m1^2*m2*sin(phi + theta)*cos(theta)*sin(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) + ((g*l*m2*sin(phi + theta) + g*h*m1*sin(theta) + (R*mu*sgn_slip*(2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta)))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)))*(l^2*m2^3*sin(phi + theta)^2 - J2*m2^2 - l^2*m2^3 - J2*m1^2 - 2*l^2*m1*m2^2 - l^2*m1^2*m2 - 2*J2*m1*m2 + l^2*m2^3*cos(phi + theta)^2 + l^2*m1*m2^2*cos(phi + theta)^2 + l^2*m1*m2^2*sin(phi + theta)^2 + h*l*m1*m2^2*sin(phi + theta)*sin(theta) + h*l*m1^2*m2*sin(phi + theta)*sin(theta) + h*l*m1*m2^2*cos(phi + theta)*cos(theta) + h*l*m1^2*m2*cos(phi + theta)*cos(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) - ((theta_d*(l*m2*cos(phi + theta)*(phi_d + theta_d) + h*m1*theta_d*cos(theta)) - (2*J1*J2*g*m1^2 + 2*J1*J2*g*m2^2 + 2*J2*g*h^2*m1*m2^2 + 2*J2*g*h^2*m1^2*m2 + 2*J1*g*l^2*m1*m2^2 + 2*J1*g*l^2*m1^2*m2 + 4*J1*J2*g*m1*m2 + g*h^2*l^2*m1^2*m2^2 + h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi + theta) + h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi + theta) - g*h^2*l^2*m1^2*m2^2*cos(2*phi) + 2*J1*l^3*m1*m2^2*phi_d^2*cos(phi + theta) + 2*J1*l^3*m1*m2^2*theta_d^2*cos(phi + theta) + h^3*l^2*m1^2*m2^2*theta_d^2*cos(theta) + 2*J2*h^3*m1^2*m2*theta_d^2*cos(theta) - h^2*l^3*m1^2*m2^2*phi_d^2*cos(phi - theta) - h^2*l^3*m1^2*m2^2*theta_d^2*cos(phi - theta) - h^3*l^2*m1^2*m2^2*theta_d^2*cos(2*phi + theta) + 2*J1*J2*l*m2^2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m2^2*theta_d^2*cos(phi + theta) + 2*J1*J2*h*m1^2*theta_d^2*cos(theta) + 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi + theta) + 4*J1*l^3*m1*m2^2*phi_d*theta_d*cos(phi + theta) - 2*h^2*l^3*m1^2*m2^2*phi_d*theta_d*cos(phi - theta) + 2*J2*h^2*l*m1*m2^2*phi_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*phi_d^2*cos(phi + theta) + 2*J2*h^2*l*m1*m2^2*theta_d^2*cos(phi + theta) + J2*h^2*l*m1^2*m2*theta_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*phi_d^2*cos(phi + theta) + 2*J1*J2*l*m1*m2*theta_d^2*cos(phi + theta) + 4*J1*J2*l*m2^2*phi_d*theta_d*cos(phi + theta) + J1*h*l^2*m1*m2^2*theta_d^2*cos(theta) + 2*J1*h*l^2*m1^2*m2*theta_d^2*cos(theta) + 2*J1*J2*h*m1*m2*theta_d^2*cos(theta) - J2*h^2*l*m1^2*m2*phi_d^2*cos(phi - theta) - J1*h*l^2*m1*m2^2*theta_d^2*cos(2*phi + theta) - J2*h^2*l*m1^2*m2*theta_d^2*cos(phi - theta) - 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi - theta) + 4*J2*h^2*l*m1*m2^2*phi_d*theta_d*cos(phi + theta) + 2*J2*h^2*l*m1^2*m2*phi_d*theta_d*cos(phi + theta) + 4*J1*J2*l*m1*m2*phi_d*theta_d*cos(phi + theta))/(J2*h^2*m1^2 + J1*l^2*m2^2 + 2*J1*J2*m1 + 2*J1*J2*m2 + h^2*l^2*m1*m2^2 + h^2*l^2*m1^2*m2 + 2*J2*h^2*m1*m2 + 2*J1*l^2*m1*m2 - J2*h^2*m1^2*cos(2*theta) - J1*l^2*m2^2*cos(2*phi + 2*theta) - h^2*l^2*m1^2*m2*cos(2*theta) - h^2*l^2*m1*m2^2*cos(2*phi + 2*theta) - J2*h^2*m1^2*mu*sgn_slip*sin(2*theta) - J1*l^2*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) - h^2*l^2*m1^2*m2*mu*sgn_slip*sin(2*theta) - h^2*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + 2*theta) + 2*J2*R*h*m1^2*mu*sgn_slip*sin(theta) + 2*J2*R*h*m1*m2*mu*sgn_slip*sin(theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(2*phi + theta) + R*h*l^2*m1*m2^2*mu*sgn_slip*sin(theta) + 2*R*h*l^2*m1^2*m2*mu*sgn_slip*sin(theta)) + g*(m2 + m1) + l*m2*phi_d*cos(phi + theta)*(phi_d + theta_d))*(J1*l*m2^2*sin(phi + theta) - J2*h*m1^2*sin(theta) + h^2*l*m1*m2^2*sin(phi + theta) + h^2*l*m1^2*m2*sin(phi + theta) + J1*l*m1*m2*sin(phi + theta) - h*l^2*m1*m2^2*sin(theta) - h*l^2*m1^2*m2*sin(theta) - J2*h*m1*m2*sin(theta) + h*l^2*m1*m2^2*cos(phi + theta)^2*sin(theta) - h^2*l*m1^2*m2*sin(phi + theta)*cos(theta)^2 - h*l^2*m1*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta) + h^2*l*m1^2*m2*cos(phi + theta)*cos(theta)*sin(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta)) + (g*l*m2*sin(phi + theta)*(J1*m1^2 + J1*m2^2 + J2*m1^2 + J2*m2^2 + h^2*m1^3 + l^2*m2^3 - l^2*m2^3*sin(phi + theta)^2 - h^2*m1^3*cos(theta)^2 - h^2*m1^3*sin(theta)^2 + h^2*m1*m2^2 + 2*h^2*m1^2*m2 + 2*l^2*m1*m2^2 + l^2*m1^2*m2 + 2*J1*m1*m2 + 2*J2*m1*m2 - l^2*m2^3*cos(phi + theta)^2 - l^2*m1*m2^2*cos(phi + theta)^2 - l^2*m1*m2^2*sin(phi + theta)^2 - h^2*m1^2*m2*cos(theta)^2 - h^2*m1^2*m2*sin(theta)^2 - 2*h*l*m1*m2^2*sin(phi + theta)*sin(theta) - 2*h*l*m1^2*m2*sin(phi + theta)*sin(theta) - 2*h*l*m1*m2^2*cos(phi + theta)*cos(theta) - 2*h*l*m1^2*m2*cos(phi + theta)*cos(theta)))/(J1*l^2*m2^3*cos(phi + theta)^2 - J1*l^2*m2^3 - J1*J2*m1^2 - J1*J2*m2^2 - h^2*l^2*m1*m2^3 - h^2*l^2*m1^3*m2 - J2*h^2*m1^3 + J1*l^2*m2^3*sin(phi + theta)^2 + J2*h^2*m1^3*cos(theta)^2 + J2*h^2*m1^3*sin(theta)^2 - 2*h^2*l^2*m1^2*m2^2 - J2*h^2*m1*m2^2 - 2*J2*h^2*m1^2*m2 - 2*J1*l^2*m1*m2^2 - J1*l^2*m1^2*m2 - 2*J1*J2*m1*m2 + h^2*l^2*m1*m2^3*cos(phi + theta)^2 + h^2*l^2*m1*m2^3*sin(phi + theta)^2 + h^2*l^2*m1^3*m2*cos(theta)^2 + h^2*l^2*m1^3*m2*sin(theta)^2 + h^2*l^2*m1^2*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(phi + theta)^2 + J1*l^2*m1*m2^2*cos(phi + theta)^2 + h^2*l^2*m1^2*m2^2*cos(theta)^2 + J1*l^2*m1*m2^2*sin(phi + theta)^2 + h^2*l^2*m1^2*m2^2*sin(theta)^2 + J2*h^2*m1^2*m2*cos(theta)^2 + J2*h^2*m1^2*m2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*cos(phi + theta)^2*sin(theta)^2 - h^2*l^2*m1^2*m2^2*sin(phi + theta)^2*cos(theta)^2 + 2*h^2*l^2*m1^2*m2^2*cos(phi + theta)*sin(phi + theta)*cos(theta)*sin(theta))];

    dXdt=[dq1;dq2];
end